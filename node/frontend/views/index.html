<!doctype html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> 	<html lang="en"> <!--<![endif]-->
<head>

	<!-- Basic Page Needs
  ================================================== -->
	<meta charset="utf-8" />
	<title>Sector67 Dashboard</title>
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	
	<!-- Mobile Specific Metas
  ================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 
	
	<!-- CSS
  ================================================== -->
	<link rel="stylesheet" href="stylesheets/base.css">
	<link rel="stylesheet" href="stylesheets/skeleton.css">
	<link rel="stylesheet" href="stylesheets/layout.css">
	
	<link rel="stylesheet" href="javascripts/jguage/css/jgauge.css" type="text/css" /> <!-- CSS for jGauge styling. -->
	<!--[if IE]><script type="text/javascript" language="javascript" src="javascripts/jguage/js/excanvas.min.js"></script><![endif]--> <!-- Extends canvas support to IE. (Possibly buggy, need to look into this.) -->
	
	<!-- Favicons
	================================================== -->
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png" />
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png" />
	
	<script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>
	
</head>
<body>





	<!-- Primary Page Layout
	================================================== -->
	
	<!-- Delete everything in this .container and get started on your own site! -->

	<div id="back"><a href="http://www.sector67.org">Learn more about Sector67</a></div>
	
	<div class="container">
		
		<div class="sixteen columns" style="margin-bottom: 10px">
			<img class="logo" src="images/sector67.png" />
		</div>
		
		
		<div id="welcome" class="sixteen columns">
			<h1>Dashboard</h1>
			<p>Real-time data from the Sector67 car at the "Power Racing Series". From our ground-up home grown motor controller to it's uber-performant Ultima batteries... see what we see, every step of the way.</p>
		</div>
		
		<div class="sixteen columns">
			<div class="one-third column feature">
				<h2>Speed</h2> 
				<div id="speed" class="jgauge"></div>
			</div>
		
			<div class="one-third column feature">
			
				<h2>Battery</h2>
				<div id="batteries" class="jgauge"></div>
			</div>
			</div>
		
		<div class="one-third column feature">
			<h2>Telemetry Temp</h2>
			<div id="telTemp" class="jgauge"></div>
		</div>
		<div class="one-third column feature">
			<h2>Left Motor Temp</h2>
			<div id="leftTemp" class="jgauge"></div>
		</div>
		<div class="one-third column feature">
			<h2>Right Motor Temp</h2>
			<div id="rightTemp" class="jgauge"></div>
		</div>
		
		<div class="sixteen columns">
			<h2>Current Location</h2>
			<div id="map_canvas" style="height: 300px; margin-bottom: 50px;"></div>
		</div>
		
		<div class="sixteen columns">
			<h2>...more to come</h2>
		</div>
		

	</div><!-- container -->

		
		
		
		
	<!-- JS
	================================================== -->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js"></script>
	<script>window.jQuery || document.write("<script src='javascripts/jquery-1.5.1.min.js'>\x3C/script>")</script>
	<script language="javascript" type="text/javascript" src="javascripts/jguage/js/jQueryRotate.min.js"></script>
	<script language="javascript" type="text/javascript" src="javascripts/jguage/js/jgauge-0.3.0.a3.js"></script>
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
	<script src="/socket.io/socket.io.js"></script>
	
	<script>
	
		var telTempGauge = new jGauge(); // Create a new jGauge.
		telTempGauge.id = 'telTemp';
		telTempGauge.autoPrefix = autoPrefix.si; // Use SI prefixing (i.e. 1k = 1000).
		telTempGauge.imagePath = 'javascripts/jguage/img/jgauge_face_taco.png';
		telTempGauge.segmentStart = -225
		telTempGauge.segmentEnd = 45
		telTempGauge.width = 170;
		telTempGauge.height = 170;
		telTempGauge.needle.imagePath = 'javascripts/jguage/img/jgauge_needle_taco.png';
		telTempGauge.needle.xOffset = 0;
		telTempGauge.needle.yOffset = 0;
		telTempGauge.label.yOffset = 55;
		telTempGauge.label.color = '#fff';
		telTempGauge.label.precision = 0; // 0 decimals (whole numbers).
		telTempGauge.label.suffix = '&deg F'; // Make the value label watts.
		telTempGauge.ticks.labelRadius = 45;
		telTempGauge.ticks.labelColor = '#0ce';
		telTempGauge.ticks.start = 0;
		telTempGauge.ticks.end = 200;
		telTempGauge.ticks.count = 12;
		telTempGauge.ticks.color = 'rgba(0, 0, 0, 0)';
		telTempGauge.range.color = 'rgba(0, 0, 0, 0)';
		
		var leftMotorTempGauge = new jGauge(); // Create a new jGauge.
		leftMotorTempGauge.id = 'leftTemp';
		leftMotorTempGauge.autoPrefix = autoPrefix.si; // Use SI prefixing (i.e. 1k = 1000).
		leftMotorTempGauge.imagePath = 'javascripts/jguage/img/jgauge_face_taco.png';
		leftMotorTempGauge.segmentStart = -225
		leftMotorTempGauge.segmentEnd = 45
		leftMotorTempGauge.width = 170;
		leftMotorTempGauge.height = 170;
		leftMotorTempGauge.needle.imagePath = 'javascripts/jguage/img/jgauge_needle_taco.png';
		leftMotorTempGauge.needle.xOffset = 0;
		leftMotorTempGauge.needle.yOffset = 0;
		leftMotorTempGauge.label.yOffset = 55;
		leftMotorTempGauge.label.color = '#fff';
		leftMotorTempGauge.label.precision = 0; // 0 decimals (whole numbers).
		leftMotorTempGauge.label.suffix = '&deg F'; // Make the value label watts.
		leftMotorTempGauge.ticks.labelRadius = 45;
		leftMotorTempGauge.ticks.labelColor = '#0ce';
		leftMotorTempGauge.ticks.start = 0;
		leftMotorTempGauge.ticks.end = 200;
		leftMotorTempGauge.ticks.count = 12;
		leftMotorTempGauge.ticks.color = 'rgba(0, 0, 0, 0)';
		leftMotorTempGauge.range.color = 'rgba(0, 0, 0, 0)';
		
		var rightMotorTempGauge = new jGauge(); // Create a new jGauge.
		rightMotorTempGauge.id = 'rightTemp';
		rightMotorTempGauge.autoPrefix = autoPrefix.si; // Use SI prefixing (i.e. 1k = 1000).
		rightMotorTempGauge.imagePath = 'javascripts/jguage/img/jgauge_face_taco.png';
		rightMotorTempGauge.segmentStart = -225
		rightMotorTempGauge.segmentEnd = 45
		rightMotorTempGauge.width = 170;
		rightMotorTempGauge.height = 170;
		rightMotorTempGauge.needle.imagePath = 'javascripts/jguage/img/jgauge_needle_taco.png';
		rightMotorTempGauge.needle.xOffset = 0;
		rightMotorTempGauge.needle.yOffset = 0;
		rightMotorTempGauge.label.yOffset = 55;
		rightMotorTempGauge.label.color = '#fff';
		rightMotorTempGauge.label.precision = 0; // 0 decimals (whole numbers).
		rightMotorTempGauge.label.suffix = '&deg F'; // Make the value label watts.
		rightMotorTempGauge.ticks.labelRadius = 45;
		rightMotorTempGauge.ticks.labelColor = '#0ce';
		rightMotorTempGauge.ticks.start = 0;
		rightMotorTempGauge.ticks.end = 200;
		rightMotorTempGauge.ticks.count = 12;
		rightMotorTempGauge.ticks.color = 'rgba(0, 0, 0, 0)';
		rightMotorTempGauge.range.color = 'rgba(0, 0, 0, 0)';
	
		var batteryGauge = new jGauge(); // Create a new jGauge.
		batteryGauge.id = 'batteries';
		batteryGauge.autoPrefix = autoPrefix.si; // Use SI prefixing (i.e. 1k = 1000).
		batteryGauge.imagePath = 'javascripts/jguage/img/jgauge_face_taco.png';
		batteryGauge.segmentStart = -225
		batteryGauge.segmentEnd = 45
		batteryGauge.width = 170;
		batteryGauge.height = 170;
		batteryGauge.needle.imagePath = 'javascripts/jguage/img/jgauge_needle_taco.png';
		batteryGauge.needle.xOffset = 0;
		batteryGauge.needle.yOffset = 0;
		batteryGauge.label.yOffset = 55;
		batteryGauge.label.color = '#fff';
		batteryGauge.label.precision = 0; // 0 decimals (whole numbers).
		batteryGauge.label.suffix = 'V'; // Make the value label watts.
		batteryGauge.ticks.labelRadius = 45;
		batteryGauge.ticks.labelColor = '#0ce';
		batteryGauge.ticks.start = 0;
		batteryGauge.ticks.end = 36;
		batteryGauge.ticks.count = 12;
		batteryGauge.ticks.color = 'rgba(0, 0, 0, 0)';
		batteryGauge.range.color = 'rgba(0, 0, 0, 0)';
	
	
		var speedGauge = new jGauge(); // Create a new jGauge.
		speedGauge.id = 'speed';
		speedGauge.autoPrefix = autoPrefix.si; // Use SI prefixing (i.e. 1k = 1000).
		speedGauge.imagePath = 'javascripts/jguage/img/jgauge_face_taco.png';
		speedGauge.segmentStart = -225
		speedGauge.segmentEnd = 45
		speedGauge.width = 170;
		speedGauge.height = 170;
		speedGauge.needle.imagePath = 'javascripts/jguage/img/jgauge_needle_taco.png';
		speedGauge.needle.xOffset = 0;
		speedGauge.needle.yOffset = 0;
		speedGauge.label.yOffset = 55;
		speedGauge.label.color = '#fff';
		speedGauge.label.precision = 0; // 0 decimals (whole numbers).
		speedGauge.label.suffix = 'MPH'; // Make the value label watts.
		speedGauge.ticks.labelRadius = 45;
		speedGauge.ticks.labelColor = '#0ce';
		speedGauge.ticks.start = 0;
		speedGauge.ticks.end = 35;
		speedGauge.ticks.count = 10;
		speedGauge.ticks.color = 'rgba(0, 0, 0, 0)';
		speedGauge.range.color = 'rgba(0, 0, 0, 0)';
	
		$(document).ready(function () {
			
			function initialize() {
				var myOptions = {
					zoom: 8,
					center: new google.maps.LatLng(-34.397, 150.644),
					mapTypeId: google.maps.MapTypeId.ROADMAP
				};
				map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);
			}

			google.maps.event.addDomListener(window, 'load', initialize);
							
							
			speedGauge.init();
			batteryGauge.init();
			telTempGauge.init();
			leftMotorTempGauge.init();
			rightMotorTempGauge.init();
			
			var socket = io.connect('http://localhost');
			socket.on('gps', function (data) {
				speedGauge.setValue(data.data.speed);
				var marker = new google.maps.Marker({
					position: new google.maps.LatLng(data.data.latitude, data.data.longitude),
					icon: 'http://mapicons.nicolasmollet.com/wp-content/uploads/mapicons/shape-default/color-ff0000/shapecolor-color/shadow-1/border-dark/symbolstyle-white/symbolshadowstyle-dark/gradient-no/sportscar.png',
					map: map
				});
				map.setCenter(marker.position);

			});
			
			socket.on('temp', function (data) {
				if(data.data.temperature > 0) {
					if (data.data.sensorName == "telemetry") {
							telTempGauge.setValue(data.data.temperature);	
					} else if (data.data.sensorName == "leftMotor") {
							leftMotorTempGauge.setValue(data.data.temperature);						
					} if (data.data.sensorName == "rightMotor") {
							rightMotorTempGauge.setValue(data.data.temperature);	
					}
				}
			});
			
			socket.on('volts', function (data) {
						batteryGauge.setValue(data.data.voltage);	
			});
			
			
		});
	</script>
	
<!-- End Document
================================================== -->
</body>
</html>